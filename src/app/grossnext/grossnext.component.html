<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" 
integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script type="text/javascript" charset="utf-8" src="ebapi-modules.js"></script>

<script src="JSPrintManager.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bluebird/3.3.5/bluebird.min.js"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Open+Sans&family=Orbitron&family=Roboto+Condensed&display=swap');
    </style>
<div class="container-12">
    <nav class="navbar">
        <ul class="navbar-nav">
            <li class="nav-item active">
             <label class="logo">SMART</label>
             <label class="logo2">PATH</label>
             <label class="logo">SOFT</label>
            </li>   </ul>
            <div>
                <label  class="stavka2" (click)="poc()"  style="text-align: center; align-self: center;
                align-items: center;
                align-content: center;"><a href="/grossfirst">GROSSING</a></label>  
            </div>
        <ul class="navbar-nav">
            <li class="nav-item active">
            
                   <label  class="stavka2"  style="text-align: center; align-self: center;
                   align-items: center;
                   align-content: center;">dr. {{me.firstname}} {{me.lastname}}</label>  
                
                <label (click)="logout()"  class="stavka3"  style="text-align: center; align-self: center;
                align-items: center;
                align-content: center;"><a href="/login-grossing">LOGOUT</a></label>      
            </li>   
            </ul>
        
            
                

              
           
     
    
       </nav>
<div class="col-12">
 
    
    <div class="pozadina">
        <div class="pt1">
      <div class="case">
        <div class="c1">
            <label>Case ID:</label>
            <label>First name:</label>
            <label> Last name:</label>
            </div>
            <div class="c1">
                <label class="a1">{{myCase.formatcn}}</label>
                <label class="a1">{{myCase.firstname}}</label>
                <label class="a1">{{myCase.lastname}}</label>
            </div>
   
      </div></div>
    <div class="middle">
<div class="opt">
<div  *ngFor="let s of mySamples; let i=index" (click)="plavi(s, i)">
    <div *ngIf="lamp[i]==0" class="cards">
    <div ><img class="slika2" src="../../assets/Group 752.png"></div>
    <label class="lab2">{{s.slovo}}</label></div>
    <div *ngIf="lamp[i]==1" class="cards1">
        <div ><img class="slika2" src="../../assets/Group 752.png"></div>
        <label class="lab2">{{s.slovo}}</label></div>
</div>

</div>

<div class="k" >
  <div class="adddiv" *ngIf="sem1==1">
    <button class="pm2" (click)="dkas()">DELETE CASSETTE</button>
    <button class="pm2" (click)="pkas()">ADD CASSETTE</button>
  </div>
<div class="zaScroll">
<div class="kasetice" *ngFor="let r of kasetice; let i=index;">

<div class="basic" *ngIf="sem1==1">
    <div class="whitediv">
<div class="plocice1">
<div class="plusminus">
   
</div>
<img class="slika3" src="../../assets/касетица.png" style="text-align: center;">
<label>{{r}}</label>
</div>
<div class="pddiv">
<button class="pdButton" (click)="print(i,r)" onclick="print();">PRINT</button>
<div><span id="print_status"></span></div>
</div></div>
<div class="plocice">
    <div class="kaspt2">
    <div class="plusminus">
        <button class="pm" (click)="oduzmip(r)">-</button>
        <button class="pm" (click)="dodp(r)">+</button>
    </div><div class="pl1">
    <img class="slika4" src="../../assets/novaplocica.png" >
    
    <label >{{r}}.{{brP}}</label>
</div>
</div>
    
</div>
<div class="ostplo">
<div class="jedna" >
    
    
    <label class="fl" *ngIf="r.indexOf">x{{plocice[i]}}</label>
</div>
</div>
</div>

<div class="comm">
    <label class="comlab">Comments(ex. slice...)</label>
    <input type="text" class="incom" [(ngModel)]="comm[i]" rows="2" cols="20" >
</div>
</div>
</div>
</div>
<div class="selectm">
   
  <div class="selmenifirst">
    <input class="insearch" placeholder="🔎︎ Search special stain" [(ngModel)]='searchss' (change)="searchssin()">
    <input class="insearch" placeholder="🔎︎ Search ihc" [(ngModel)]='searchihc'  (change)="searchihcin()">
  </div>
  <div class="selmenifirst">
    <form class="fr1">
        <div class="multiselect">
          <div class="selectBox" (click)="showCheckboxes()">
            <select class="select1">
              <option>SPECIAL STAIN</option>
            </select>
            <div class="overSelect"></div>
          </div>
          <div id="checkboxes">
            <div class="oneopt" *ngFor='let b of array1; let i=index'>
              <div class="exblop1">
             {{b}} 
              </div>
              <div class="exblop">
                <button class="buttss" (click)="exblumanji(i)">-</button>
              <label>{{niz1[i]}}</label>
              
              <button class="buttss1" (click)="exblpovecaj(i)">+</button>
              </div>
       
         </div>

          </div>
        </div>
      </form>
 
  
    <form>
        <div class="multiselect">
          <div class="selectBox" (click)="showCheckboxes2()">
            <select class="select1">
              <option>IHC</option>
            </select>
            <div class="overSelect"></div>
          </div>
          <div id="checkboxes1">
            <div class="oneopt" *ngFor='let b of array2; let i=index'>
              <div class="exblop1">
                {{b}} 
              </div>
              <div class="exblop">
                <button class="buttss" (click)="exblumanji2(i)">-</button>
                  <label>{{niz2[i]}}</label>
             
                  <button class="buttss1" (click)="exblpovecaj2(i)">+</button>
               </div>
            </div>

          </div>
        </div>
      </form>
    </div>
</div>
<div class="d1" *ngIf="znakD==1 ">
    <div class="d1A">
    <button class="dugme" (click)="addW()">DONE CASSETTE</button>
    <span class='error'>{{message}}</span>
    </div>
    <qr-code  class='ssdiv' *ngIf="qri!=null" [value]="qri"></qr-code>
</div>
<div class="d1" *ngIf="message=='Aleready added' ">
  <div class="d1A">
    <span class='error'>{{message}}</span>
    </div>
</div>
    </div>
    </div>
    <div class="footer">
        <p>© M-Rising 2022</p>
      </div>
</div>
</div>
<script>

  //WebSocket settings
  JSPM.JSPrintManager.auto_reconnect = true;
  JSPM.JSPrintManager.start();
  JSPM.JSPrintManager.WS.onStatusChanged = function () {
      if (jspmWSStatus()) {
          //get client installed printers
          JSPM.JSPrintManager.getPrinters().then(function (myPrinters) {
              var options = '';
              for (var i = 0; i < myPrinters.length; i++) {
          options += '<option>' + myPrinters[i] + '</option>';
      }
              $('#installedPrinterName').html(options);
          });
      }
  };
  function jspmWSStatus() {
        if (JSPM.JSPrintManager.websocket_status == JSPM.WSStatus.Open)
            return true;
        else if (JSPM.JSPrintManager.websocket_status == JSPM.WSStatus.Closed) {
            alert('JSPrintManager (JSPM) is not installed or not running! Download JSPM Client App from https://neodynamic.com/downloads/jspm');
            return false;
        }
        else if (JSPM.JSPrintManager.websocket_status == JSPM.WSStatus.Blocked) {
            alert('JSPM has blocked this website!');
            return false;
        }
    }

      //Do printing...
      function print(o) {
        if (jspmWSStatus()) {
            //Create a ClientPrintJob
            var cpj = new JSPM.ClientPrintJob();
            //Set Printer type (Refer to the help, there many of them!)
          
                cpj.clientPrinter = new JSPM.InstalledPrinter($('#installedPrinterName').val());
            
            //Set content to print...
            //Create Zebra ZPL commands for sample label
            var cmds =  "^XA";
            cmds += "^FO20,30^GB750,1100,4^FS";
            cmds += "^FO20,30^GB750,200,4^FS";
            cmds += "^FO20,30^GB750,400,4^FS";
            cmds += "^FO20,30^GB750,700,4^FS";
            cmds += "^FO20,226^GB325,204,4^FS";
            cmds += "^FO30,40^ADN,36,20^FDShip to:^FS";
            cmds += "^FO30,260^ADN,18,10^FDPart number #^FS";
            cmds += "^FO360,260^ADN,18,10^FDDescription:^FS";
            cmds += "^FO30,750^ADN,36,20^FDFrom:^FS";
            cmds += "^FO150,125^ADN,36,20^FDAcme Printing^FS";
            cmds += "^FO60,330^ADN,36,20^FD14042^FS";
            cmds += "^FO400,330^ADN,36,20^FDScrew^FS";
            cmds += "^FO70,480^BY4^B3N,,200^FD12345678^FS";
            cmds += "^FO150,800^ADN,36,20^FDMacks Fabricating^FS";
            cmds += "^XZ";
            cpj.printerCommands = cmds;
            //Send print job to printer!
            cpj.sendToClient();
        }
    }

  </script>
